@use super::{footer, head_canon, me_box};
@use crate::models::{Post, Tag};
@use i18n_embed::fluent::FluentLanguageLoader;
@use i18n_embed::LanguageLoader;
@use i18n_embed_fl::fl;

@(fluent: &FluentLanguageLoader, posts: &[(Post, Vec<Tag>)], years: &[i16])

<!doctype html>
<html lang="@fluent.current_language()">
  <head>
    <title>Rasmus.krats.se</title>
    @:head_canon()
  </head>
  <body>
    <header>
      <h1>Rasmus​.krats​.se</h1>
      <p class="tagline">@fl!(fluent, "tagline")</p>
    </header>
    <main>
      @for (post, tags) in posts {
      <article id="post_@(post.year)_@post.slug" lang="@post.lang">
        <h2><a href="@post.url()">@Html(&post.title)</a></h2>
        <p class="publine">@Html(post.publine(tags))</p>
        @Html(&post.content)
      </article>
      }

      @if let Some((first, rest)) = years.split_first() {
      <p>@fl!(fluent, "from-year")
        <a href="/@first/@fluent.current_language()">@first</a>@for year in rest {,
        <a href="/@year/@fluent.current_language()">@year</a>}.</p>
      }
    </main>
    @:me_box()
    @:footer(fluent)
  </body>
</html>
